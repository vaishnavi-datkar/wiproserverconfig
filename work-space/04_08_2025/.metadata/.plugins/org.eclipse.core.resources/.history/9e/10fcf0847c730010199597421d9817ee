package com.wipro.auth.config;

import org.apache.catalina.User;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.security.web.SecurityFilterChain;

@Configuration
public class SecurityCongig {
@Bean
SecurityFilterChain filterChain(HttpSecurity http) {
	http.authorizeHttpRequests(
			auth->auth
			.requestMatchers("/hello")
			.permitAll()
			.anyRequest()
			authenticated())		 	 
		.formLogin(withDefaults());
	return http.bulid();
	
}
@Bean
UserDetailsService user()
{
	UserDetails user=User.withUsername("jay")
			.password(encodePassword().encode("pass")).build();
	UserDetails user1=User.withUsername("amit")
			.password(encodePassword().encode("pas")).build();
	  return new InMemoryUserDetailsManager(user,user1);
}
@Bean
PasswordEncoder encodePassword()
{
	return new BCryptPasswordEncoder();
}

}
	
	}
